# 🌿 Plant Disease Classifier

A deep learning project to classify plant leaf diseases using a Convolutional Neural Network (CNN).  
It provides both a training script and a Flask-based web application with a drag-and-drop frontend.

---

## 🚀 Features
- Train a CNN on [PlantVillage dataset](https://www.kaggle.com/datasets/emmarex/plantdisease).
- Save model in `.h5` format with class indices.
- Flask backend for prediction (`/predict` API).
- Modern frontend (`index.html`) for uploading images.
- Returns top prediction with confidence score.

---

## 🗂 Project Structure
```
.
├── app.py                # Flask API for inference
├── train.py              # Model training script
├── templates/
│   └── index.html        # Frontend UI
├── models/
│   ├── plant_disease_model.h5   # Saved Keras model (generated by train.py)
│   └── class_indices.json       # Class labels mapping
├── requirements.txt      # Dependencies
└── README.md
```

---

## 📊 Dataset

We use the [PlantVillage dataset](https://www.kaggle.com/datasets/emmarex/plantdisease) which contains over **50,000 images** of healthy and diseased plant leaves categorized into multiple classes.

Download the dataset from Kaggle and place it in a folder named `PlantVillage/` before running training.

---

## ⚙️ Setup & Installation

1. **Clone this repository**
   ```bash
   git clone https://github.com/your-username/plant-disease-classifier.git
   cd plant-disease-classifier
   ```

2. **Create a virtual environment (recommended)**
   ```bash
   python -m venv venv
   source venv/bin/activate   # Linux/Mac
   venv\Scripts\activate      # Windows
   ```

3. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

---

## 🧑‍🔬 Training

Make sure you have the PlantVillage dataset in a folder called `PlantVillage/`  
(each subfolder = class name).

```bash
python train.py
```

This will:
- Train the CNN
- Save the model in `models/plant_disease_model.h5`
- Save label mapping in `models/class_indices.json`

---

## 🌐 Running the Web App

Start the Flask server:

```bash
python app.py
```

Go to:  
👉 [http://127.0.0.1:5000](http://127.0.0.1:5000)

Upload an image to see predictions.

---

## 📡 API Usage

- Endpoint: `POST /predict`
- Content-Type: `multipart/form-data`
- Field: `file`

### Example (Python)
```python
import requests

url = "http://127.0.0.1:5000/predict"
files = {"file": open("leaf.jpg", "rb")}
res = requests.post(url, files=files)
print(res.json())
```

Response:
```json
{
  "top": {
    "label": "Tomato_Leaf_Mold",
    "prob": 0.87
  }
}
```

---

## 🛠 Requirements
See [`requirements.txt`](./requirements.txt).

---

